<!DOCTYPE html>
<html manifest="./ccache.manifest">

<head>
  <script>
    function DLProgress(e) { Percent = (Math.round(e.loaded / e.total * 100)); document.title = "Installing offline cache: " + Percent + "%"; }
    function DisplayCacheProgress() { setTimeout(function () { ; document.title = "Cache Success !"; }, 1000); setTimeout(function () { window.location.href = document.referrer; }, 3000); } window.applicationCache.addEventListener("progress", DLProgress, false); window.applicationCache.oncached = function (e) { DisplayCacheProgress(); }; window.applicationCache.onupdateready = function (e) { DisplayCacheProgress(); };
  </script>
  <meta charset="UTF-8">
  <title>PSFree Webkit + Lapse Kernel Exploit</title>
  <link rel='stylesheet' href='./index.css'>
</head>

<body>


  <div class="header">
    <img src="./logo.svg" width="50" height="50"></button>
  </div>
  </div>

  <h1>PSFree Webkit + Lapse Kernel Exploit</h1>

  <h2 id="PS4FW">Firware Compatible</h2>

  <div id="jailbreak-page">
    <div class="center-btn-wrap">
      <button id="jailbreak" class="ps-btn" title="GoldHen">
        <!-- PlayStation SVG logo -->
        <img src="./GoldHen.png" width="100" height="50"></button>
      <label>

      </label>
    </div>

  </div>

  <div id="jailbreak-page">
    <div class="center-btn-wrap2">
      <button id="jailbreak2" class="ps-btn" title="Hen">
        <!-- PlayStation SVG logo -->
        <img src="./Hen.png" width="100" height="50"></button>
      <label>

      </label>
    </div>

  </div>

  <h3>Exploit Console</h3>

  <div class="console" style="padding: 20px;">
    <pre id='console'>Waiting for user interaction...</pre>
  </div>

  <button class="btn" onmouseover="msgs.innerHTML='Modify PS4 FAN Speed'"
    onmouseout="msgs.innerHTML='PS4 9.00 FW Host v2.8 by GamerHack'" onclick="load_fanthreshold()"> Fan Threshold
  </button><select id="tempC"></select>&#176;C
  <br>

  <script>
    function allset() {
      msgs.innerHTML = LoadedMSG
    }

    function load_poc() {
      if (sessionStorage.exploit == "yes") {
        var req = new XMLHttpRequest();
        req.responseType = "arraybuffer";
        req.open('GET', PLfile);
        req.send();
        req.onreadystatechange = function () {
          if (req.readyState == 4) {
            PLD = req.response;
            var payload_buffer = chain.syscall(477, 0, PLD.byteLength * 4, 7, 0x1002, -1, 0);
            var pl = p.array_from_address(payload_buffer, PLD.byteLength * 4);
            var padding = new Uint8Array(4 - (req.response.byteLength % 4) % 4);
            var tmp = new Uint8Array(req.response.byteLength + padding.byteLength);
            tmp.set(new Uint8Array(req.response), 0);
            tmp.set(padding, req.response.byteLength);
            var shellcode = new Uint32Array(tmp.buffer);
            pl.set(shellcode, 0);
            var pthread = p.malloc(0x10);
            chain.call(libKernelBase.add32(OFFSET_lk_pthread_create), pthread, 0x0, payload_buffer, 0);
            setTimeout(allset, 50);
          }
        };
      }
      else {
        setTimeout(poc, 1500);
      }
    }

    function exec_binserver() {
      var payload_buffer = chain.syscall(477, 0x0, 0x300000, 0x7, 0x1000, 0xFFFFFFFF, 0);
      var payload_loader = p.malloc32(0x1000);

      var loader_writer = payload_loader.backing;
      loader_writer[0] = 0x56415741;
      loader_writer[1] = 0x83485541;
      loader_writer[2] = 0x894818EC;
      loader_writer[3] = 0xC748243C;
      loader_writer[4] = 0x10082444;
      loader_writer[5] = 0x483C2302;
      loader_writer[6] = 0x102444C7;
      loader_writer[7] = 0x00000000;
      loader_writer[8] = 0x000002BF;
      loader_writer[9] = 0x0001BE00;
      loader_writer[10] = 0xD2310000;
      loader_writer[11] = 0x00009CE8;
      loader_writer[12] = 0xC7894100;
      loader_writer[13] = 0x8D48C789;
      loader_writer[14] = 0xBA082474;
      loader_writer[15] = 0x00000010;
      loader_writer[16] = 0x000095E8;
      loader_writer[17] = 0xFF894400;
      loader_writer[18] = 0x000001BE;
      loader_writer[19] = 0x0095E800;
      loader_writer[20] = 0x89440000;
      loader_writer[21] = 0x31F631FF;
      loader_writer[22] = 0x0062E8D2;
      loader_writer[23] = 0x89410000;
      loader_writer[24] = 0x2C8B4CC6;
      loader_writer[25] = 0x45C64124;
      loader_writer[26] = 0x05EBC300;
      loader_writer[27] = 0x01499848;
      loader_writer[28] = 0xF78944C5;
      loader_writer[29] = 0xBAEE894C;
      loader_writer[30] = 0x00001000;
      loader_writer[31] = 0x000025E8;
      loader_writer[32] = 0x7FC08500;
      loader_writer[33] = 0xFF8944E7;
      loader_writer[34] = 0x000026E8;
      loader_writer[35] = 0xF7894400;
      loader_writer[36] = 0x00001EE8;
      loader_writer[37] = 0x2414FF00;
      loader_writer[38] = 0x18C48348;
      loader_writer[39] = 0x5E415D41;
      loader_writer[40] = 0x31485F41;
      loader_writer[41] = 0xC748C3C0;
      loader_writer[42] = 0x000003C0;
      loader_writer[43] = 0xCA894900;
      loader_writer[44] = 0x48C3050F;
      loader_writer[45] = 0x0006C0C7;
      loader_writer[46] = 0x89490000;
      loader_writer[47] = 0xC3050FCA;
      loader_writer[48] = 0x1EC0C748;
      loader_writer[49] = 0x49000000;
      loader_writer[50] = 0x050FCA89;
      loader_writer[51] = 0xC0C748C3;
      loader_writer[52] = 0x00000061;
      loader_writer[53] = 0x0FCA8949;
      loader_writer[54] = 0xC748C305;
      loader_writer[55] = 0x000068C0;
      loader_writer[56] = 0xCA894900;
      loader_writer[57] = 0x48C3050F;
      loader_writer[58] = 0x006AC0C7;
      loader_writer[59] = 0x89490000;
      loader_writer[60] = 0xC3050FCA;
      chain.syscall(74, payload_loader, 0x4000, (0x1 | 0x2 | 0x4));

      var pthread = p.malloc(0x10);
      //
      {
        chain.fcall(window.syscalls[203], payload_buffer, 0x300000);
        chain.fcall(libKernelBase.add32(OFFSET_lk_pthread_create), pthread, 0x0, payload_loader, payload_buffer);
      }
      chain.run();
      sessionStorage.netcat = "no";
      LoadedMSG = "Bin Loader Launched ...";
      alert("Waiting for Payload... Send it using the PS4 IP and port 9020");
      setTimeout(allset, 50);
    }

    function loadScript(path) {
      var xhr = new XMLHttpRequest(path);
      xhr.open("GET", path, false);
      xhr.send('');
      return xhr.responseText;
    }

    for (var i = 40; i <= 75; i = i + 5) {
      var select = document.getElementById("tempC");
      var option = document.createElement("OPTION");
      select.options.add(option);
      option.text = i;
      option.value = i;
    }
    tempC.value = 60;

    function load_enablebUpdates() {
      msgs.innerHTML = "Loading Enable Updates... Please Wait"
      LoadedMSG = "Enable Updates Loaded ..."
      PLfile = "enable-updates.bin";
      load_poc();
    }

    function load_disableUpdates() {
      msgs.innerHTML = "Loading Disable Updates... Please Wait"
      LoadedMSG = "Disable Updates Loaded ..."
      PLfile = "disable-updates.bin";
      load_poc();
    }
    function load_fanthreshold() {
      msgs.innerHTML = "Loading Fan Threshold... Please Wait"
      LoadedMSG = "Fan Threshold Loaded ..."
      PLfile = "fan-threshold" + tempC.value + ".bin";
      load_poc();
    }
  </script>

  <script src='./index.js'></script>
  <script>
    CheckFW()
  </script>
</body>

</html>